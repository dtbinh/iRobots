import java.awt.Color;
import java.awt.Graphics;
import java.awt.Point;
import java.awt.Polygon;
import java.awt.Window.Type;
import java.util.ArrayList;

import javax.swing.JPanel;


public class Field extends JPanel
{
	private ArrayList<Message> msg;
	
	public Field()
	{
		initComponents();
		msg = new ArrayList<>();
	}
	
	public void addMessage(Message m)
	{
		msg.add(m);
		updated();
	}
	
	public void initComponents()
	{
		this.setBackground(Color.WHITE);
	}
	
	@Override
	public void paintComponent( Graphics g ) 
	{
        super.paintComponent(g);
        g.setColor(Color.BLUE);
        if(msg.size()> 0) 
        {
        	Message m  = msg.get(msg.size()-1); //get me the last element
        	int x = (m.getX() * this.getHeight())/100;
        	int y = (m.getY() * this.getHeight())/100;
        	Polygon p0 = new Polygon();
        	Polygon p1 = new Polygon();
        	Polygon p2 = new Polygon();
        	if(m.getType().equals("pos"))
			{
				g.drawRect(x,y, 100, 100);
			}
        	for(Message ms : msg)
        	{
        		if(ms.getType().equals("pos")) {
        				switch(ms.getId()) {
        				case "0" : p0.addPoint(ms.getX(), ms.getY());
        				break;
        				case "1" : p1.addPoint(ms.getX(), ms.getY());
        				break;
        				case "2" : p2.addPoint(ms.getX(), ms.getY());
        				break;
        				default : System.err.println("Unknown ID");
        			}
        		}
        	}
        	g.drawPolygon(p0);
        	g.drawPolygon(p1);
        	g.drawPolygon(p2);
        }
	}
	
	//called after a new entry in the list
	public void updated()
	{
		Message m  = msg.get(msg.size()-1); //get me the last element
		if(m.getType().equals("pos"))
		{
			invalidate();
			repaint();
		}
	}
}
